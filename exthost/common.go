// SPDX-License-Identifier: MIT
// SPDX-FileCopyrightText: 2025 Steadybit GmbH

package exthost

import (
	"fmt"
	"github.com/steadybit/action-kit/go/action_kit_api/v2"
	"github.com/steadybit/extension-kit"
	"github.com/steadybit/extension-kit/extutil"
	"os"
)

const (
	WindowsHostTechnology = "Windows Host"

	targetID   = "com.steadybit.extension_host_windows.host"
	targetIcon = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.65%202.064a.993.993%200%2001.7%200l10%203.776a1.01%201.01%200%20010%201.889l-10%203.773a.993.993%200%2001-.7%200l-10-3.773A1.008%201.008%200%20011%206.784c0-.42.259-.796.65-.944l10-3.776zM1.063%2017.03a.998.998%200%20011.287-.591L12%2020.082l9.649-3.644a.998.998%200%20011.287.59%201.01%201.01%200%2001-.586%201.299l-10%203.776a.993.993%200%2001-.7%200l-10-3.776a1.01%201.01%200%2001-.586-1.298zm1.287-5.89a.998.998%200%2000-1.287.59%201.01%201.01%200%2000.586%201.299l10%203.776a.993.993%200%2000.7%200l10-3.776a1.01%201.01%200%2000.586-1.298.998.998%200%2000-1.287-.59L12%2014.782l-9.649-3.644z%22%20fill%3D%22currentColor%22%2F%3E%3C%2Fsvg%3E"

	BaseActionID    = "com.steadybit.extension_host_windows"
	shutdownIcon    = "data:image/svg+xml,%3Csvg%20width%3D%2219%22%20height%3D%2222%22%20viewBox%3D%220%200%2019%2022%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M9.23122%200C9.64544%200%209.98122%200.335786%209.98122%200.75V10.0536C9.98122%2010.4678%209.64544%2010.8036%209.23122%2010.8036C8.81701%2010.8036%208.48122%2010.4678%208.48122%2010.0536V0.75C8.48122%200.335786%208.81701%200%209.23122%200ZM11.3867%203.85221C11.5248%203.46167%2011.9533%203.25699%2012.3438%203.39503C14.1646%204.03861%2015.741%205.23087%2016.856%206.8076C17.971%208.38434%2018.5697%2010.268%2018.5697%2012.1991C18.5697%2014.1303%2017.971%2016.0139%2016.856%2017.5907C15.741%2019.1674%2014.1646%2020.3597%2012.3438%2021.0032L12.3345%2021.0065C10.0089%2021.7942%207.46664%2021.6342%205.2581%2020.5613C3.04956%2019.4884%201.35239%2017.5889%200.533964%2015.274C-0.284465%2012.9591%20-0.158301%2010.415%200.885145%208.19237C1.92859%205.96978%203.80537%204.24753%206.10922%203.39843C6.49787%203.25518%206.92906%203.45413%207.07231%203.84279C7.21555%204.23145%207.0166%204.66264%206.62794%204.80588C4.69413%205.5186%203.11881%206.96422%202.24296%208.82983C1.36711%2010.6954%201.26121%2012.8309%201.94818%2014.774C2.63515%2016.7171%204.05973%2018.3115%205.91353%2019.2121C7.76584%2020.1119%209.89777%2020.2466%2011.8485%2019.5874C13.3749%2019.0468%2014.6963%2018.0467%2015.6313%2016.7246C16.5672%2015.4011%2017.0697%2013.8201%2017.0697%2012.1991C17.0697%2010.5782%2016.5672%208.99713%2015.6313%207.67367C14.6954%206.35022%2013.3722%205.34948%2011.8439%204.80928C11.4534%204.67124%2011.2487%204.24274%2011.3867%203.85221Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"
	stopProcessIcon = "data:image/svg+xml,%3Csvg%20width%3D%2222%22%20height%3D%2222%22%20viewBox%3D%220%200%2022%2022%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M9%208C8.44772%208%208%208.44772%208%209V13C8%2013.5523%208.44772%2014%209%2014H13C13.5523%2014%2014%2013.5523%2014%2013V9C14%208.44772%2013.5523%208%2013%208H9Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11%200.250015C5.06312%200.250015%200.25%205.06314%200.25%2011C0.25%2016.9369%205.06312%2021.75%2011%2021.75C16.9369%2021.75%2021.75%2016.9369%2021.75%2011C21.75%205.06314%2016.9369%200.250015%2011%200.250015ZM1.75%2011C1.75%205.89156%205.89155%201.75002%2011%201.75002C16.1085%201.75002%2020.25%205.89156%2020.25%2011C20.25%2016.1085%2016.1085%2020.25%2011%2020.25C5.89155%2020.25%201.75%2016.1085%201.75%2011Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"
	blackHoleIcon   = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2218%22%20viewBox%3D%220%200%2024%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M1.96299%201.55709C2.24324%201.441%202.56583%201.50517%202.78033%201.71967L4.06066%203H6.75C7.16421%203%207.5%203.33579%207.5%203.75C7.5%204.16421%207.16421%204.5%206.75%204.5H4.06066L2.78033%205.78033C2.56583%205.99483%202.24324%206.059%201.96299%205.94291C1.68273%205.82682%201.5%205.55335%201.5%205.25V4.5H0.75C0.335786%204.5%200%204.16421%200%203.75C0%203.33579%200.335786%203%200.75%203H1.5V2.25C1.5%201.94665%201.68273%201.67318%201.96299%201.55709ZM14.267%205.09123C14.3417%204.7462%2014.647%204.5%2015%204.5H16.5C16.6275%204.5%2016.7528%204.53248%2016.8642%204.59438L23.6012%208.33712C23.6195%208.34685%2023.6374%208.35732%2023.6548%208.36849C23.704%208.39998%2023.7498%208.4374%2023.791%208.48033C23.8285%208.51937%2023.8614%208.56204%2023.8892%208.60743C23.9322%208.67737%2023.9641%208.75492%2023.9824%208.83759C23.9888%208.86671%2023.9926%208.88844%2023.9955%208.91775C24.0037%208.9996%2024.0005%209.08352%2023.9824%209.16241C23.9641%209.24508%2023.9322%209.32263%2023.8892%209.39257C23.8614%209.43796%2023.8285%209.48063%2023.791%209.51967C23.7498%209.5626%2023.704%209.60002%2023.6548%209.63151C23.6374%209.64268%2023.6195%209.65315%2023.6012%209.66288L16.8642%2013.4056C16.7528%2013.4675%2016.6275%2013.5%2016.5%2013.5H15C14.647%2013.5%2014.3417%2013.2538%2014.267%2012.9088C14.1923%2012.5637%2014.3683%2012.2133%2014.6896%2012.0672L19.7875%209.75H11.25C10.8358%209.75%2010.5%209.41421%2010.5%209C10.5%208.58579%2010.8358%208.25%2011.25%208.25H19.7875L14.6896%205.93278C14.3683%205.78669%2014.1923%205.43625%2014.267%205.09123ZM3.46299%206.80709C3.74324%206.69101%204.06583%206.75517%204.28033%206.96967L5.56066%208.25H6C6.41421%208.25%206.75%208.58579%206.75%209C6.75%209.41421%206.41421%209.75%206%209.75H5.56066L4.28033%2011.0303C4.06583%2011.2448%203.74324%2011.309%203.46299%2011.1929C3.18273%2011.0768%203%2010.8033%203%2010.5V9.75H0.75C0.335786%209.75%200%209.41421%200%209C0%208.58579%200.335786%208.25%200.75%208.25H3V7.5C3%207.19665%203.18273%206.92318%203.46299%206.80709ZM1.96299%2012.0571C2.24324%2011.941%202.56583%2012.0052%202.78033%2012.2197L4.06066%2013.5H6.75C7.16421%2013.5%207.5%2013.8358%207.5%2014.25C7.5%2014.6642%207.16421%2015%206.75%2015H4.06066L2.78033%2016.2803C2.56583%2016.4948%202.24324%2016.559%201.96299%2016.4429C1.68273%2016.3268%201.5%2016.0533%201.5%2015.75V15H0.75C0.335786%2015%200%2014.6642%200%2014.25C0%2013.8358%200.335786%2013.5%200.75%2013.5H1.5V12.75C1.5%2012.4467%201.68273%2012.1732%201.96299%2012.0571Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M10.8582%202.0271C12.2166%201.19193%2013.7799%200.749779%2015.3745%200.749779C16.9691%200.749779%2018.5324%201.19193%2019.8908%202.0271L19.9001%202.03282C21.8129%203.24755%2023.1708%205.16617%2023.6806%207.37395C24.1903%209.58172%2023.8109%2011.9014%2022.6243%2013.8318C21.4378%2015.7621%2019.5393%2017.148%2017.3393%2017.6901C15.1392%2018.2322%2012.8142%2017.8868%2010.8667%2016.7286C10.5106%2016.5169%2010.3937%2016.0567%2010.6054%2015.7007C10.8171%2015.3446%2011.2773%2015.2277%2011.6333%2015.4394C13.2422%2016.3961%2015.1629%2016.6814%2016.9804%2016.2337C18.7979%2015.7859%2020.3662%2014.6409%2021.3465%2013.0463C22.3267%2011.4516%2022.6401%209.53527%2022.219%207.7114C21.7983%205.88932%2020.6782%204.3057%2019.1005%203.30205C17.9795%202.61401%2016.6899%202.24978%2015.3745%202.24978C14.0573%202.24978%2012.7659%202.61502%2011.6438%203.3049C11.291%203.52185%2010.829%203.41167%2010.6121%203.05881C10.3952%202.70596%2010.5053%202.24404%2010.8582%202.0271Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M9.55202%206.73421C9.22595%207.27773%209%208.07701%209%209C9%209.92299%209.22595%2010.7223%209.55202%2011.2658C9.88701%2011.8242%2010.2454%2012%2010.5%2012C10.7546%2012%2011.113%2011.8242%2011.448%2011.2658C11.7741%2010.7223%2012%209.92299%2012%209C12%208.07701%2011.7741%207.27773%2011.448%206.73421C11.113%206.17582%2010.7546%206%2010.5%206C10.2454%206%209.88701%206.17582%209.55202%206.73421ZM8.26573%205.96254C8.74499%205.16368%209.51158%204.5%2010.5%204.5C11.4884%204.5%2012.255%205.16368%2012.7343%205.96254C13.2224%206.77627%2013.5%207.85199%2013.5%209C13.5%2010.148%2013.2224%2011.2237%2012.7343%2012.0375C12.255%2012.8363%2011.4884%2013.5%2010.5%2013.5C9.51158%2013.5%208.74499%2012.8363%208.26573%2012.0375C7.77755%2011.2237%207.5%2010.148%207.5%209C7.5%207.85199%207.77755%206.77627%208.26573%205.96254Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"
	bandwidthIcon   = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2214%22%20viewBox%3D%220%200%2024%2014%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M9.75%2010C9.75%209.58579%2010.0858%209.25%2010.5%209.25H23.25C23.6642%209.25%2024%209.58579%2024%2010C24%2010.4142%2023.6642%2010.75%2023.25%2010.75H10.5C10.0858%2010.75%209.75%2010.4142%209.75%2010Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M19.7197%206.46967C20.0126%206.17678%2020.4874%206.17678%2020.7803%206.46967L23.7803%209.46967C24.0732%209.76256%2024.0732%2010.2374%2023.7803%2010.5303L20.7803%2013.5303C20.4874%2013.8232%2020.0126%2013.8232%2019.7197%2013.5303C19.4268%2013.2374%2019.4268%2012.7626%2019.7197%2012.4697L22.1893%2010L19.7197%207.53033C19.4268%207.23744%2019.4268%206.76256%2019.7197%206.46967Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M0%204C0%203.58579%200.335786%203.25%200.75%203.25H13.5C13.9142%203.25%2014.25%203.58579%2014.25%204C14.25%204.41421%2013.9142%204.75%2013.5%204.75H0.75C0.335786%204.75%200%204.41421%200%204Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.28033%200.46967C4.57322%200.762563%204.57322%201.23744%204.28033%201.53033L1.81066%204L4.28033%206.46967C4.57322%206.76256%204.57322%207.23744%204.28033%207.53033C3.98744%207.82322%203.51256%207.82322%203.21967%207.53033L0.21967%204.53033C-0.0732233%204.23744%20-0.0732233%203.76256%200.21967%203.46967L3.21967%200.46967C3.51256%200.176777%203.98744%200.176777%204.28033%200.46967Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"
	corruptIcon     = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url%28%23clip0_1_36412%29%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M3.87398%202.8146C4.05898%202.69098%204.27649%202.625%204.49899%202.625C4.79736%202.625%205.08351%202.74353%205.29449%202.9545C5.50547%203.16548%205.62399%203.45163%205.62399%203.75C5.62399%203.97251%205.55801%204.19001%205.4344%204.37502C5.31078%204.56002%205.13508%204.70422%204.92951%204.78936C4.72395%204.87451%204.49775%204.89679%204.27952%204.85338C4.06129%204.80997%203.86083%204.70283%203.7035%204.5455C3.54617%204.38816%203.43902%204.18771%203.39561%203.96948C3.3522%203.75125%203.37448%203.52505%203.45963%203.31948C3.54478%203.11392%203.68897%202.93821%203.87398%202.8146Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M9%203.75C9%203.33579%209.33579%203%209.75%203H11.25C11.6642%203%2012%203.33579%2012%203.75C12%204.16421%2011.6642%204.5%2011.25%204.5H9.75C9.33579%204.5%209%204.16421%209%203.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M14.25%203C13.8358%203%2013.5%203.33579%2013.5%203.75C13.5%204.16421%2013.8358%204.5%2014.25%204.5H15.75C16.1642%204.5%2016.5%204.16421%2016.5%203.75C16.5%203.33579%2016.1642%203%2015.75%203H14.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M18.0002%206.7499C18.1412%206.64407%2018.2755%206.52782%2018.4017%206.40165C19.1049%205.69839%2019.5%204.74456%2019.5%203.75C19.5%202.75544%2019.1049%201.80161%2018.4017%201.09835C17.6984%200.395088%2016.7446%200%2015.75%200H3.75C2.75544%200%201.80161%200.395088%201.09835%201.09835C0.395088%201.80161%200%202.75544%200%203.75C0%204.74456%200.395088%205.69839%201.09835%206.40165C1.22456%206.52786%201.35884%206.64414%201.49998%206.75C1.35884%206.85586%201.22456%206.97214%201.09835%207.09835C0.395088%207.80161%200%208.75544%200%209.75C0%2010.7446%200.395088%2011.6984%201.09835%2012.4017C1.80161%2013.1049%202.75544%2013.5%203.75%2013.5H7.5V18H4.5C4.08579%2018%203.75%2018.3358%203.75%2018.75C3.75%2019.1642%204.08579%2019.5%204.5%2019.5H8.25C8.66421%2019.5%209%2019.1642%209%2018.75V13.5H11.999C12.4132%2013.5%2012.749%2013.1642%2012.749%2012.75C12.749%2012.3358%2012.4132%2012%2011.999%2012H3.75C3.15326%2012%202.58097%2011.7629%202.15901%2011.341C1.73705%2010.919%201.5%2010.3467%201.5%209.75C1.5%209.15326%201.73705%208.58097%202.15901%208.15901C2.58097%207.73705%203.15326%207.5%203.75%207.5H15.75C16.1409%207.49996%2016.5251%207.60175%2016.8646%207.79534C17.2042%207.98892%2017.4875%208.26763%2017.6866%208.604C17.8975%208.96046%2018.3575%209.0784%2018.714%208.86743C19.0705%208.65645%2019.1884%208.19646%2018.9774%207.84C18.7257%207.41465%2018.3932%207.04462%2018.0002%206.7499ZM3.75%201.5C3.15326%201.5%202.58097%201.73705%202.15901%202.15901C1.73705%202.58097%201.5%203.15326%201.5%203.75C1.5%204.34674%201.73705%204.91903%202.15901%205.34099C2.58097%205.76295%203.15326%206%203.75%206H15.7499C16.3467%206%2016.919%205.76295%2017.341%205.34099C17.7629%204.91903%2018%204.34674%2018%203.75C18%203.15326%2017.7629%202.58097%2017.341%202.15901C16.919%201.73705%2016.3467%201.5%2015.75%201.5H3.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M3.87398%208.8146C4.05898%208.69098%204.27649%208.625%204.49899%208.625C4.79736%208.625%205.08351%208.74353%205.29449%208.9545C5.50547%209.16548%205.62399%209.45163%205.62399%209.75C5.62399%209.97251%205.55801%2010.19%205.4344%2010.375C5.31078%2010.56%205.13508%2010.7042%204.92951%2010.7894C4.72394%2010.8745%204.49774%2010.8968%204.27952%2010.8534C4.06129%2010.81%203.86084%2010.7028%203.7035%2010.5455C3.54617%2010.3882%203.43902%2010.1877%203.39561%209.96948C3.3522%209.75125%203.37448%209.52505%203.45963%209.31948C3.54478%209.11392%203.68897%208.93821%203.87398%208.8146Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M9.75%209C9.33579%209%209%209.33579%209%209.75C9%2010.1642%209.33579%2010.5%209.75%2010.5H11.25C11.6642%2010.5%2012%2010.1642%2012%209.75C12%209.33579%2011.6642%209%2011.25%209H9.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M16.999%2018.7615C16.6254%2018.7615%2016.3225%2018.4683%2016.3225%2018.1067V16.1422C16.3225%2015.7806%2016.6254%2015.4874%2016.999%2015.4874C17.3727%2015.4874%2017.6756%2015.7806%2017.6756%2016.1422V18.1067C17.6756%2018.4683%2017.3727%2018.7615%2016.999%2018.7615Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M15.9842%2020.3985C15.9842%2019.856%2016.4385%2019.4163%2016.999%2019.4163C17.5595%2019.4163%2018.0139%2019.856%2018.0139%2020.3985C18.0139%2020.941%2017.5595%2021.3807%2016.999%2021.3807C16.4385%2021.3807%2015.9842%2020.941%2015.9842%2020.3985Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M15.8016%2011.6997C16.3089%2010.7668%2017.6891%2010.7668%2018.1964%2011.6997L23.8415%2022.0804C24.3157%2022.9525%2023.6623%2024%2022.644%2024H11.354C10.3358%2024%209.68234%2022.9525%2010.1566%2022.0804L15.8016%2011.6997ZM22.644%2022.6904L16.999%2012.3096L11.354%2022.6904L22.644%2022.6904Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M0.749984%2017.6896C0.934988%2017.566%201.15249%2017.5%201.375%2017.5C1.67337%2017.5%201.95952%2017.6185%202.1705%2017.8295C2.38147%2018.0405%202.5%2018.3266%202.5%2018.625C2.5%2018.8475%202.43402%2019.065%202.3104%2019.25C2.18679%2019.435%202.01108%2019.5792%201.80552%2019.6644C1.59995%2019.7495%201.37375%2019.7718%201.15552%2019.7284C0.937299%2019.685%200.736842%2019.5778%200.579505%2019.4205C0.422172%2019.2632%200.315025%2019.0627%200.271616%2018.8445C0.228208%2018.6262%200.250488%2018.4%200.335636%2018.1945C0.420784%2017.9889%200.564977%2017.8132%200.749984%2017.6896Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_1_36412%22%3E%0A%3Crect%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22white%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%0A"
	delayIcon       = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url%28%23clip0_1_36430%29%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.78701%207.55709C5.06727%207.67318%205.25%207.94665%205.25%208.25V15.75C5.25%2016.0533%205.06727%2016.3268%204.78701%2016.4429C4.50676%2016.559%204.18417%2016.4948%203.96967%2016.2803L0.21967%2012.5303C-0.0732233%2012.2374%20-0.0732233%2011.7626%200.21967%2011.4697L3.96967%207.71967C4.18417%207.50517%204.50676%207.441%204.78701%207.55709ZM19.213%207.55709C19.4932%207.441%2019.8158%207.50517%2020.0303%207.71967L23.7803%2011.4697C24.0732%2011.7626%2024.0732%2012.2374%2023.7803%2012.5303L20.0303%2016.2803C19.8158%2016.4948%2019.4932%2016.559%2019.213%2016.4429C18.9327%2016.3268%2018.75%2016.0533%2018.75%2015.75V8.25C18.75%207.94665%2018.9327%207.67318%2019.213%207.55709ZM1.81066%2012L3.75%2013.9393V10.0607L1.81066%2012ZM20.25%2010.0607V13.9393L22.1893%2012L20.25%2010.0607Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M11.7348%2011.7348C11.8052%2011.6645%2011.9005%2011.625%2012%2011.625C12.0995%2011.625%2012.1948%2011.6645%2012.2652%2011.7348C12.3355%2011.8052%2012.375%2011.9005%2012.375%2012C12.375%2012.0995%2012.3355%2012.1948%2012.2652%2012.2652C12.1948%2012.3355%2012.0995%2012.375%2012%2012.375C11.9005%2012.375%2011.8052%2012.3355%2011.7348%2012.2652C11.6645%2012.1948%2011.625%2012.0995%2011.625%2012C11.625%2011.9005%2011.6645%2011.8052%2011.7348%2011.7348Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M16.2348%2011.7348C16.3052%2011.6645%2016.4005%2011.625%2016.5%2011.625C16.5995%2011.625%2016.6948%2011.6645%2016.7652%2011.7348C16.8355%2011.8052%2016.875%2011.9005%2016.875%2012C16.875%2012.0995%2016.8355%2012.1948%2016.7652%2012.2652C16.6948%2012.3355%2016.5995%2012.375%2016.5%2012.375C16.4005%2012.375%2016.3052%2012.3355%2016.2348%2012.2652C16.1645%2012.1948%2016.125%2012.0995%2016.125%2012C16.125%2011.9005%2016.1645%2011.8052%2016.2348%2011.7348Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M7.23484%2011.7348C7.30516%2011.6645%207.40054%2011.625%207.5%2011.625C7.59946%2011.625%207.69484%2011.6645%207.76516%2011.7348C7.83549%2011.8052%207.875%2011.9005%207.875%2012C7.875%2012.0995%207.83549%2012.1948%207.76516%2012.2652C7.69484%2012.3355%207.59946%2012.375%207.5%2012.375C7.40054%2012.375%207.30516%2012.3355%207.23484%2012.2652C7.16451%2012.1948%207.125%2012.0995%207.125%2012C7.125%2011.9005%207.16451%2011.8052%207.23484%2011.7348Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.7045%2011.2045C6.91548%2010.9935%207.20163%2010.875%207.5%2010.875C7.79837%2010.875%208.08452%2010.9935%208.2955%2011.2045C8.50647%2011.4155%208.625%2011.7016%208.625%2012C8.625%2012.2984%208.50647%2012.5845%208.2955%2012.7955C8.08452%2013.0065%207.79837%2013.125%207.5%2013.125C7.20163%2013.125%206.91548%2013.0065%206.7045%2012.7955C6.49353%2012.5845%206.375%2012.2984%206.375%2012C6.375%2011.7016%206.49353%2011.4155%206.7045%2011.2045ZM7.5%2012.375C7.59946%2012.375%207.69484%2012.3355%207.76516%2012.2652C7.83549%2012.1948%207.875%2012.0995%207.875%2012C7.875%2011.9005%207.83549%2011.8052%207.76516%2011.7348C7.69484%2011.6645%207.59946%2011.625%207.5%2011.625C7.40054%2011.625%207.30516%2011.6645%207.23484%2011.7348C7.16451%2011.8052%207.125%2011.9005%207.125%2012C7.125%2012.0995%207.16451%2012.1948%207.23484%2012.2652C7.30516%2012.3355%207.40054%2012.375%207.5%2012.375ZM11.2045%2011.2045C11.4155%2010.9935%2011.7016%2010.875%2012%2010.875C12.2984%2010.875%2012.5845%2010.9935%2012.7955%2011.2045C13.0065%2011.4155%2013.125%2011.7016%2013.125%2012C13.125%2012.2984%2013.0065%2012.5845%2012.7955%2012.7955C12.5845%2013.0065%2012.2984%2013.125%2012%2013.125C11.7016%2013.125%2011.4155%2013.0065%2011.2045%2012.7955C10.9935%2012.5845%2010.875%2012.2984%2010.875%2012C10.875%2011.7016%2010.9935%2011.4155%2011.2045%2011.2045ZM12%2012.375C12.0995%2012.375%2012.1948%2012.3355%2012.2652%2012.2652C12.3355%2012.1948%2012.375%2012.0995%2012.375%2012C12.375%2011.9005%2012.3355%2011.8052%2012.2652%2011.7348C12.1948%2011.6645%2012.0995%2011.625%2012%2011.625C11.9005%2011.625%2011.8052%2011.6645%2011.7348%2011.7348C11.6645%2011.8052%2011.625%2011.9005%2011.625%2012C11.625%2012.0995%2011.6645%2012.1948%2011.7348%2012.2652C11.8052%2012.3355%2011.9005%2012.375%2012%2012.375ZM15.7045%2011.2045C15.9155%2010.9935%2016.2016%2010.875%2016.5%2010.875C16.7984%2010.875%2017.0845%2010.9935%2017.2955%2011.2045C17.5065%2011.4155%2017.625%2011.7016%2017.625%2012C17.625%2012.2984%2017.5065%2012.5845%2017.2955%2012.7955C17.0845%2013.0065%2016.7984%2013.125%2016.5%2013.125C16.2016%2013.125%2015.9155%2013.0065%2015.7045%2012.7955C15.4935%2012.5845%2015.375%2012.2984%2015.375%2012C15.375%2011.7016%2015.4935%2011.4155%2015.7045%2011.2045ZM16.5%2012.375C16.5995%2012.375%2016.6948%2012.3355%2016.7652%2012.2652C16.8355%2012.1948%2016.875%2012.0995%2016.875%2012C16.875%2011.9005%2016.8355%2011.8052%2016.7652%2011.7348C16.6948%2011.6645%2016.5995%2011.625%2016.5%2011.625C16.4005%2011.625%2016.3052%2011.6645%2016.2348%2011.7348C16.1645%2011.8052%2016.125%2011.9005%2016.125%2012C16.125%2012.0995%2016.1645%2012.1948%2016.2348%2012.2652C16.3052%2012.3355%2016.4005%2012.375%2016.5%2012.375Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_1_36430%22%3E%0A%3Crect%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22white%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%0A"
	dnsIcon         = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url%28%23clip0_1_36448%29%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M17.25%2012C14.3505%2012%2012%2014.3505%2012%2017.25C12%2020.1495%2014.3505%2022.5%2017.25%2022.5C20.1495%2022.5%2022.5%2020.1495%2022.5%2017.25C22.5%2014.3505%2020.1495%2012%2017.25%2012ZM10.5%2017.25C10.5%2013.5221%2013.5221%2010.5%2017.25%2010.5C20.9779%2010.5%2024%2013.5221%2024%2017.25C24%2020.9779%2020.9779%2024%2017.25%2024C13.5221%2024%2010.5%2020.9779%2010.5%2017.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M20.0303%2014.4697C20.3232%2014.7626%2020.3232%2015.2374%2020.0303%2015.5303L15.5303%2020.0303C15.2374%2020.3232%2014.7625%2020.3232%2014.4697%2020.0303C14.1768%2019.7374%2014.1768%2019.2626%2014.4697%2018.9697L18.9697%2014.4697C19.2625%2014.1768%2019.7374%2014.1768%2020.0303%2014.4697Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M14.4697%2014.4697C14.7625%2014.1768%2015.2374%2014.1768%2015.5303%2014.4697L20.0303%2018.9697C20.3232%2019.2626%2020.3232%2019.7374%2020.0303%2020.0303C19.7374%2020.3232%2019.2625%2020.3232%2018.9697%2020.0303L14.4697%2015.5303C14.1768%2015.2374%2014.1768%2014.7626%2014.4697%2014.4697Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M15.3627%202.053C13.5088%201.42623%2011.5166%201.32999%209.61093%201.77513C7.70524%202.22028%205.96184%203.1891%204.57744%204.57231C3.19303%205.95552%202.22269%207.69806%201.77589%209.60337C1.32908%2011.5087%201.42359%2013.5009%202.04875%2015.3554C2.67392%2017.2099%203.80486%2018.8527%205.31399%2020.0987C6.82312%2021.3446%208.65039%2022.144%2010.5897%2022.4068C11.0001%2022.4624%2011.2878%2022.8402%2011.2322%2023.2507C11.1766%2023.6612%2010.7987%2023.9488%2010.3883%2023.8932C8.17199%2023.5929%206.0837%2022.6793%204.359%2021.2554C2.6343%2019.8315%201.34181%2017.9539%200.62735%2015.8346C-0.0871135%2013.7152%20-0.195124%2011.4384%200.315502%209.26091C0.826129%207.08344%201.93507%205.09198%203.51724%203.51119C5.0994%201.9304%207.09182%200.823187%209.26974%200.314453C11.4477%20-0.194281%2013.7244%20-0.0842913%2015.8431%200.632014C17.9619%201.34832%2019.8383%202.64244%2021.2607%204.36837C22.6831%206.09431%2023.5949%208.1834%2023.8933%2010.4C23.9485%2010.8105%2023.6605%2011.188%2023.25%2011.2433C22.8395%2011.2986%2022.4619%2011.0106%2022.4067%2010.6C22.1456%208.66054%2021.3478%206.83257%2020.1031%205.32236C18.8585%203.81214%2017.2166%202.67978%2015.3627%202.053Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M9.7112%200.459135C10.0535%200.69232%2010.142%201.15888%209.90884%201.50122C8.50723%203.55895%207.49998%207.44148%207.49998%2012C7.49998%2016.5586%208.50726%2020.442%209.90876%2022.4986C10.142%2022.8409%2010.0536%2023.3075%209.71133%2023.5408C9.36903%2023.774%208.90246%2023.6856%208.6692%2023.3433C7.0287%2020.936%205.99998%2016.7074%205.99998%2012C5.99998%207.29252%207.02873%203.06505%208.66912%200.656781C8.9023%200.314439%209.36886%200.22595%209.7112%200.459135Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M0.0249805%2011.25C0.0249805%2010.8358%200.360767%2010.5%200.774981%2010.5H10.5C10.9142%2010.5%2011.25%2010.8358%2011.25%2011.25C11.25%2011.6642%2010.9142%2012%2010.5%2012H0.774981C0.360767%2012%200.0249805%2011.6642%200.0249805%2011.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M2.24898%205.25C2.24898%204.83579%202.58477%204.5%202.99898%204.5H21C21.4142%204.5%2021.75%204.83579%2021.75%205.25C21.75%205.66421%2021.4142%206%2021%206H2.99898C2.58477%206%202.24898%205.66421%202.24898%205.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M1.29798%2017.25C1.29798%2016.8358%201.63377%2016.5%202.04798%2016.5H7.21398C7.62819%2016.5%207.96398%2016.8358%207.96398%2017.25C7.96398%2017.6642%207.62819%2018%207.21398%2018H2.04798C1.63377%2018%201.29798%2017.6642%201.29798%2017.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M14.3288%200.43368C14.6852%200.222607%2015.1452%200.340418%2015.3563%200.696818C16.7069%202.9774%2017.53%205.5314%2017.765%208.17149C17.8018%208.58407%2017.4971%208.94831%2017.0845%208.98504C16.6719%209.02178%2016.3077%208.71709%2016.2709%208.30451C16.0557%205.88741%2015.3022%203.54914%2014.0657%201.46118C13.8546%201.10478%2013.9724%200.644753%2014.3288%200.43368Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_1_36448%22%3E%0A%3Crect%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22white%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%0A"
	lossIcon        = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url%28%23clip0_1_36459%29%22%3E%0A%3Cpath%20d%3D%22M4.49998%203.375C4.42581%203.375%204.35331%203.39699%204.29164%203.4382C4.22997%203.4794%204.1819%203.53797%204.15352%203.60649C4.12514%203.67502%204.11771%203.75042%204.13218%203.82316C4.14665%203.8959%204.18237%203.96272%204.23481%204.01516C4.28726%204.06761%204.35408%204.10333%204.42682%204.11779C4.49956%204.13226%204.57496%204.12484%204.64348%204.09645C4.712%204.06807%204.77057%204.02001%204.81178%203.95834C4.85298%203.89667%204.87498%203.82417%204.87498%203.75C4.87498%203.65054%204.83547%203.55516%204.76514%203.48483C4.69482%203.41451%204.59943%203.375%204.49998%203.375Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M3.87496%202.8146C4.05997%202.69098%204.27747%202.625%204.49998%202.625C4.79835%202.625%205.08449%202.74353%205.29547%202.9545C5.50645%203.16548%205.62498%203.45163%205.62498%203.75C5.62498%203.97251%205.559%204.19001%205.43538%204.37502C5.31176%204.56002%205.13606%204.70422%204.9305%204.78936C4.72493%204.87451%204.49873%204.89679%204.2805%204.85338C4.06227%204.80997%203.86181%204.70283%203.70448%204.5455C3.54715%204.38816%203.44%204.18771%203.39659%203.96948C3.35318%203.75125%203.37546%203.52505%203.46061%203.31948C3.54576%203.11392%203.68995%202.93821%203.87496%202.8146ZM4.64348%204.09645C4.66607%204.0871%204.68779%204.07551%204.70832%204.0618C4.74946%204.03431%204.78455%203.99909%204.81178%203.95834C4.82536%203.93801%204.83699%203.91631%204.84643%203.89351C4.86537%203.84779%204.87498%203.79901%204.87498%203.75C4.87498%203.72555%204.87259%203.70105%204.86777%203.67684C4.8533%203.6041%204.81758%203.53728%204.76514%203.48483C4.7127%203.43239%204.64588%203.39668%204.57314%203.38221C4.54893%203.37739%204.52442%203.375%204.49998%203.375C4.45097%203.375%204.40219%203.38461%204.35647%203.40354C4.33367%203.41299%204.31196%203.42462%204.29164%203.4382C4.25089%203.46543%204.21567%203.50052%204.18818%203.54166C4.17446%203.56218%204.16288%203.58391%204.15352%203.60649C4.13477%203.65177%204.12498%203.70051%204.12498%203.75C4.12498%203.77475%204.12742%203.79924%204.13218%203.82316C4.14665%203.8959%204.18237%203.96272%204.23481%204.01516C4.28726%204.06761%204.35408%204.10333%204.42682%204.11779C4.45074%204.12255%204.47523%204.125%204.49998%204.125C4.54946%204.125%204.5982%204.11521%204.64348%204.09645Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M9.00098%203.75C9.00098%203.33579%209.33676%203%209.75098%203H11.251C11.6652%203%2012.001%203.33579%2012.001%203.75C12.001%204.16421%2011.6652%204.5%2011.251%204.5H9.75098C9.33676%204.5%209.00098%204.16421%209.00098%203.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M13.501%203.75C13.501%203.33579%2013.8368%203%2014.251%203H15.751C16.1652%203%2016.501%203.33579%2016.501%203.75C16.501%204.16421%2016.1652%204.5%2015.751%204.5H14.251C13.8368%204.5%2013.501%204.16421%2013.501%203.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M4.49998%209.375C4.42581%209.375%204.35331%209.39699%204.29164%209.4382C4.22997%209.4794%204.1819%209.53797%204.15352%209.60649C4.12514%209.67502%204.11771%209.75042%204.13218%209.82316C4.14665%209.8959%204.18237%209.96272%204.23481%2010.0152C4.28726%2010.0676%204.35408%2010.1033%204.42682%2010.1178C4.49956%2010.1323%204.57496%2010.1248%204.64348%2010.0965C4.712%2010.0681%204.77057%2010.02%204.81178%209.95834C4.85298%209.89667%204.87498%209.82417%204.87498%209.75C4.87498%209.65054%204.83547%209.55516%204.76514%209.48483C4.69482%209.41451%204.59943%209.375%204.49998%209.375Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M3.87496%208.8146C4.05996%208.69098%204.27747%208.625%204.49998%208.625C4.79834%208.625%205.08449%208.74353%205.29547%208.9545C5.50645%209.16548%205.62498%209.45163%205.62498%209.75C5.62498%209.97251%205.559%2010.19%205.43538%2010.375C5.31176%2010.56%205.13606%2010.7042%204.9305%2010.7894C4.72493%2010.8745%204.49873%2010.8968%204.2805%2010.8534C4.06228%2010.81%203.86182%2010.7028%203.70448%2010.5455C3.54715%2010.3882%203.44%2010.1877%203.39659%209.96948C3.35318%209.75125%203.37546%209.52505%203.46061%209.31948C3.54576%209.11391%203.68995%208.93821%203.87496%208.8146ZM4.64348%2010.0965C4.66607%2010.0871%204.68779%2010.0755%204.70832%2010.0618C4.74946%2010.0343%204.78455%209.99909%204.81178%209.95834C4.82536%209.93801%204.83699%209.91631%204.84643%209.89351C4.86537%209.84779%204.87498%209.79901%204.87498%209.75C4.87498%209.72555%204.87259%209.70105%204.86777%209.67684C4.8533%209.6041%204.81758%209.53728%204.76514%209.48483C4.71269%209.43239%204.64587%209.39667%204.57314%209.38221C4.54893%209.37739%204.52442%209.375%204.49998%209.375C4.45097%209.375%204.40219%209.38461%204.35647%209.40355C4.33367%209.41299%204.31196%209.42462%204.29164%209.4382C4.25089%209.46543%204.21567%209.50052%204.18818%209.54166C4.17446%209.56218%204.16288%209.58391%204.15352%209.60649C4.13477%209.65177%204.12498%209.70051%204.12498%209.75C4.12498%209.77475%204.12742%209.79924%204.13218%209.82316C4.14665%209.8959%204.18237%209.96272%204.23481%2010.0152C4.28726%2010.0676%204.35408%2010.1033%204.42682%2010.1178C4.45074%2010.1226%204.47523%2010.125%204.49998%2010.125C4.54946%2010.125%204.5982%2010.1152%204.64348%2010.0965Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M9.00098%209.75C9.00098%209.33579%209.33676%209%209.75098%209H11.251C11.6652%209%2012.001%209.33579%2012.001%209.75C12.001%2010.1642%2011.6652%2010.5%2011.251%2010.5H9.75098C9.33676%2010.5%209.00098%2010.1642%209.00098%209.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M8.25098%2012C8.66519%2012%209.00098%2012.3358%209.00098%2012.75V18.75C9.00098%2019.1642%208.66519%2019.5%208.25098%2019.5H4.50098C4.08676%2019.5%203.75098%2019.1642%203.75098%2018.75C3.75098%2018.3358%204.08676%2018%204.50098%2018H7.50098V12.75C7.50098%2012.3358%207.83676%2012%208.25098%2012Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M1.12598%2018C1.05181%2018%200.979306%2018.022%200.917638%2018.0632C0.855969%2018.1044%200.807905%2018.163%200.779522%2018.2315C0.751139%2018.3%200.743713%2018.3754%200.758182%2018.4482C0.772652%2018.5209%200.808367%2018.5877%200.860812%2018.6402C0.913256%2018.6926%200.980075%2018.7283%201.05282%2018.7428C1.12556%2018.7573%201.20096%2018.7498%201.26948%2018.7215C1.33801%2018.6931%201.39657%2018.645%201.43778%2018.5833C1.47898%2018.5217%201.50098%2018.4492%201.50098%2018.375C1.50098%2018.2755%201.46147%2018.1802%201.39114%2018.1098C1.32082%2018.0395%201.22543%2018%201.12598%2018Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M3.75098%201.5C3.15424%201.5%202.58194%201.73705%202.15999%202.15901C1.73803%202.58097%201.50098%203.15326%201.50098%203.75C1.50098%204.34674%201.73803%204.91903%202.15999%205.34099C2.58194%205.76295%203.15424%206%203.75098%206H15.751C16.3477%206%2016.92%205.76295%2017.342%205.34099C17.7639%204.91903%2018.001%204.34674%2018.001%203.75C18.001%203.15326%2017.7639%202.58097%2017.342%202.15901C16.92%201.73705%2016.3477%201.5%2015.751%201.5H3.75098ZM1.09933%201.09835C1.80259%200.395088%202.75641%200%203.75098%200H15.751C16.7455%200%2017.6994%200.395088%2018.4026%201.09835C19.1059%201.80161%2019.501%202.75544%2019.501%203.75C19.501%204.74456%2019.1059%205.69839%2018.4026%206.40165C17.6994%207.10491%2016.7455%207.5%2015.751%207.5H3.75098C2.75641%207.5%201.80259%207.10491%201.09933%206.40165C0.396065%205.69839%200.000976562%204.74456%200.000976562%203.75C0.000976562%202.75544%200.396065%201.80161%201.09933%201.09835Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M16.8773%207.80108C16.535%207.60359%2016.1462%207.49975%2015.751%207.5H3.75098C3.15424%207.5%202.58194%207.73705%202.15999%208.15901C1.73803%208.58097%201.50098%209.15326%201.50098%209.75C1.50098%2010.3467%201.73803%2010.919%202.15999%2011.341C2.58194%2011.7629%203.15424%2012%203.75098%2012H9.72998C10.1442%2012%2010.48%2012.3358%2010.48%2012.75C10.48%2013.1642%2010.1442%2013.5%209.72998%2013.5H3.75098C2.75641%2013.5%201.80259%2013.1049%201.09933%2012.4017C0.396065%2011.6984%200.000976562%2010.7446%200.000976562%209.75C0.000976562%208.75544%200.396065%207.80161%201.09933%207.09835C1.80259%206.39509%202.75641%206%203.75098%206H15.751C15.7509%206%2015.751%206%2015.751%206C16.4095%205.99966%2017.0565%206.17273%2017.6269%206.5018C18.1974%206.83096%2018.6712%207.30457%2019.0005%207.875C19.2076%208.23372%2019.0847%208.69241%2018.726%208.89952C18.3673%209.10663%2017.9086%208.98372%2017.7015%208.625C17.5039%208.28274%2017.2196%207.99857%2016.8773%207.80108Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M17.251%2012C14.3515%2012%2012.001%2014.3505%2012.001%2017.25C12.001%2020.1495%2014.3515%2022.5%2017.251%2022.5C20.1505%2022.5%2022.501%2020.1495%2022.501%2017.25C22.501%2014.3505%2020.1505%2012%2017.251%2012ZM10.501%2017.25C10.501%2013.5221%2013.5231%2010.5%2017.251%2010.5C20.9789%2010.5%2024.001%2013.5221%2024.001%2017.25C24.001%2020.9779%2020.9789%2024%2017.251%2024C13.5231%2024%2010.501%2020.9779%2010.501%2017.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M20.0313%2014.4687C20.3242%2014.7616%2020.3242%2015.2364%2020.0313%2015.5293L15.5313%2020.0293C15.2384%2020.3222%2014.7635%2020.3222%2014.4706%2020.0293C14.1778%2019.7364%2014.1778%2019.2616%2014.4706%2018.9687L18.9706%2014.4687C19.2635%2014.1758%2019.7384%2014.1758%2020.0313%2014.4687Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M14.4706%2014.4687C14.7635%2014.1758%2015.2384%2014.1758%2015.5313%2014.4687L20.0313%2018.9687C20.3242%2019.2616%2020.3242%2019.7364%2020.0313%2020.0293C19.7384%2020.3222%2019.2635%2020.3222%2018.9706%2020.0293L14.4706%2015.5293C14.1778%2015.2364%2014.1778%2014.7616%2014.4706%2014.4687Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_1_36459%22%3E%0A%3Crect%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22white%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%0A"
)

var (
	targetSelectionTemplates = []action_kit_api.TargetSelectionTemplate{
		{
			Label:       "host name",
			Description: extutil.Ptr("Find host by host name."),
			Query:       "host.hostname=\"\"",
		}, {
			Label:       "host os",
			Description: extutil.Ptr("Find host by host os."),
			Query:       "host.os=\"windows\"",
		},
	}
	osHostname = os.Hostname
)

func CheckTargetHostname(attributes map[string][]string) (*string, error) {
	hostname := attributes["host.hostname"]
	if len(hostname) == 0 || hostname[0] == "" {
		return nil, extension_kit.ToError("Target is missing the 'host.hostname' attribute.", nil)
	}
	osHostname, err := osHostname()
	if err != nil {
		return nil, extension_kit.ToError("Failed to get hostname.", err)
	}
	if hostname[0] != osHostname {
		return nil, extension_kit.ToError(fmt.Sprintf("Target (%s) is not the current host (%s).", hostname[0], osHostname), nil)
	}
	return extutil.Ptr(osHostname), nil
}

func getRestrictedEndpoints(request action_kit_api.PrepareActionRequestBody) []action_kit_api.RestrictedEndpoint {
	var restrictedEndpoints []action_kit_api.RestrictedEndpoint
	if request.ExecutionContext != nil && request.ExecutionContext.RestrictedEndpoints != nil {
		restrictedEndpoints = *request.ExecutionContext.RestrictedEndpoints
	}
	return restrictedEndpoints
}
